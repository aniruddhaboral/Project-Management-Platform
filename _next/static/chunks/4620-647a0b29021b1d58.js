"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4620],{58680:(e,t,a)=>{a.d(t,{H:()=>n,j:()=>r});var s=a(95155),l=a(12115);let i=(0,l.createContext)(void 0);function r(e){let{children:t,onTaskUpdate:a}=e,[r,n]=(0,l.useState)(null),[d,o]=(0,l.useState)(""),[c,u]=(0,l.useState)(!1);return(0,s.jsx)(i.Provider,{value:{selectedTask:r,projectName:d,isDrawerOpen:c,openDrawer:(e,t)=>{n(e),o(t),u(!0)},setSelectedTask:n,closeDrawer:()=>{u(!1),n(null)},updateTaskTitle:(e,t)=>{n(a=>(null==a?void 0:a.id)===e?{...a,title:t}:a),null==a||a(e,{title:t})},updateTaskDescription:(e,t)=>{n(a=>(null==a?void 0:a.id)===e?{...a,description:t}:a),null==a||a(e,{description:t})},updateTaskLabels:(e,t)=>{n(a=>(null==a?void 0:a.id)===e?{...a,labels:t}:a),null==a||a(e,{labels:t||[]})},updateTaskSize:(e,t)=>{n(a=>(null==a?void 0:a.id)===e?{...a,size:t||void 0}:a),null==a||a(e,{size:t})},updateTaskPriority:(e,t)=>{n(a=>(null==a?void 0:a.id)===e?{...a,priority:t||void 0}:a),null==a||a(e,{priority:t})}},children:t})}let n=()=>{let e=(0,l.useContext)(i);if(void 0===e)throw Error("useTaskDetails must be used within a TaskDetailsProvider");return e}},55589:(e,t,a)=>{a.d(t,{V:()=>D});var s=a(95155),l=a(14085),i=a(98867),r=a(23920),n=a(12115),d=a(22730),o=a(9955),c=a(29602),u=a(40767);let m=e=>{let{title:t,isEditing:a,setIsEditing:r,onSave:m}=e,[x,h]=(0,n.useState)(t),[v,p]=(0,n.useState)(!1),j=async()=>{try{p(!0),await m(x),r(!1)}catch(e){console.error("Failed to save title:",e)}finally{p(!1)}};return a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex-grow mr-2",children:(0,s.jsx)(o.p,{type:"text",value:x,onChange:e=>h(e.target.value),className:"border border-gray-300 rounded p-1 h-8",disabled:v})}),(0,s.jsxs)("div",{className:"space-x-2",children:[(0,s.jsxs)(l.$,{onClick:j,className:(0,c.cn)(d.iH,"px-2 md:px-4"),disabled:v,children:[(0,s.jsx)("span",{className:"hidden md:inline",children:v?"Saving...":"Save"}),(0,s.jsx)("span",{className:"md:hidden",children:(0,s.jsx)(i.A,{className:"w-3 h-3"})})]}),(0,s.jsxs)(l.$,{onClick:()=>{h(t),r(!1)},className:(0,c.cn)(d.RA,"px-2 md:px-4"),disabled:v,children:[(0,s.jsx)("span",{className:"hidden md:inline",children:"Cancel"}),(0,s.jsx)("span",{className:"md:hidden",children:(0,s.jsx)(u.A,{className:"w-3 h-3"})})]})]})]}):(0,s.jsxs)("div",{className:"flex flex-grow items-center",children:[(0,s.jsx)("h1",{title:t,className:"text-left text-sm sm:text-md md:text-2xl lg:text-3xl flex-grow truncate",children:x}),(0,s.jsx)(l.$,{onClick:()=>r(!0),className:(0,c.cn)(d.RA,"px-2 h-7 hidden md:inline-flex "),children:"Edit"})]})};var x=a(20750),h=a(89134);let v=()=>{let[e,t]=(0,n.useState)(!1);return{isCopied:e,handleCopy:async e=>{try{await navigator.clipboard.writeText(e),t(!0),setTimeout(()=>t(!1),2e3)}catch(e){console.error("Failed to copy: ",e)}}}};var p=a(48748),j=a(84954),f=a(84858),g=a(73580),y=a(35765),b=a(19993),N=a(67396),w=a(76046),k=a(58680);let S=e=>{let{permalink:t,setIsEditing:a}=e,{isCopied:l,handleCopy:d}=v(),{projectId:o}=(0,w.useParams)(),{selectedTask:c,closeDrawer:u}=(0,k.H)(),{deleteTask:m}=(0,j.R)((null==c?void 0:c.id)||""),[S,_]=(0,n.useState)(!1),{reloadProjectTasks:D}=(0,p.J)(o),C=async()=>{_(!0),await m(),await D(),u(),(0,h.oR)({title:"Task deleted",description:"The task has been deleted successfully"}),_(!1)};return(0,s.jsxs)(x.rI,{children:[(0,s.jsx)(x.ty,{className:"ml-2",children:(0,s.jsx)(f.A,{className:"w-6 h-6 text-gray-600"})}),(0,s.jsxs)(x.SQ,{className:"mr-4",children:[(0,s.jsxs)("div",{className:"md:hidden",children:[(0,s.jsxs)(x._2,{onClick:()=>a(!0),children:[(0,s.jsx)(g.A,{className:"w-4 h-4 mr-2"}),"Edit"]}),(0,s.jsx)(x._2,{onClick:()=>d(t),children:l?(0,s.jsxs)("span",{className:"flex",children:[(0,s.jsx)(i.A,{className:"w-4 h-4 mr-2 text-green-600"}),(0,s.jsx)("span",{children:"Copied"})]}):(0,s.jsxs)("span",{className:"flex",children:[(0,s.jsx)(r.A,{className:"w-4 h-4 mr-2"}),(0,s.jsx)("span",{children:"Copy permalink"})]})})]}),(0,s.jsx)(N.default,{href:t,target:"_blank",rel:"noreferrer",children:(0,s.jsxs)(x._2,{children:[(0,s.jsx)(y.A,{className:"w-4 h-4 mr-2"}),"Open in new tab"]})}),(0,s.jsx)(x.mB,{}),(0,s.jsxs)(x._2,{onClick:C,disabled:S,className:"text-red-500 bg-transparent hover:bg-red-200 hover:dark:bg-red-950",children:[(0,s.jsx)(b.A,{className:"w-3 h-3 mr-2"}),S?"Deleting...":"Delete"]})]})]})};var _=a(95475);let D=e=>{var t;let{title:a,taskId:d,hideCopyLink:o=!1,onTitleUpdate:c}=e,u=(0,w.usePathname)(),[x,h]=(0,n.useState)(!1),{isCopied:p,handleCopy:j}=v(),f="".concat(null===(t=location)||void 0===t?void 0:t.origin).concat(u,"/").concat(d),g=async e=>{await _.v.details.update(d,{title:e}),null==c||c(e)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m,{title:a,isEditing:x,setIsEditing:h,onSave:g}),!o&&(0,s.jsxs)("div",{className:"flex items-center gap-3 ml-4",children:[(0,s.jsx)(l.$,{className:"p-1 bg-transparent hover:bg-transparent hidden md:block",title:"Copy permalink",onClick:()=>j(f),children:p?(0,s.jsx)(i.A,{className:"w-4 h-4 text-green-600"}):(0,s.jsx)(r.A,{className:"w-4 h-4 text-gray-600"})}),(0,s.jsx)(S,{setIsEditing:h,permalink:f})]})]})}},87800:(e,t,a)=>{a.d(t,{U:()=>e_});var s=a(95155),l=a(14432),i=a(14085),r=a(12115),n=a(22730),d=a(33375),o=a(84954),c=a(29602),u=a(73580),m=a(58680),x=a(48748),h=a(76046);let v=()=>{var e,t,a,v,p;let j=(0,h.useParams)(),{selectedTask:f}=(0,m.H)(),{task:g,updateDescription:y}=(0,o.R)((null==f?void 0:f.id)||""),{members:b}=(0,x.J)(j.projectId),[N,w]=(0,r.useState)((null==g?void 0:g.description)||""),[k,S]=(0,r.useState)(!1),[_,D]=(0,r.useState)(!1),C=async()=>{if(null==f?void 0:f.id)try{D(!0),await y(N),S(!1)}catch(e){console.error("Failed to save description:",e)}finally{D(!1)}};return(0,s.jsxs)("div",{className:"border border-sky-200 dark:border-blue-900 rounded",children:[(0,s.jsxs)("div",{className:"flex items-center justify-end bg-sky-100 dark:bg-slate-900 rounded-t border-b border-sky-200 dark:border-blue-900 overflow-x-auto px-4 py-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center gap-2 text-sm",children:[(0,s.jsx)(d.q,{id:null==f?void 0:null===(e=f.creator)||void 0===e?void 0:e.id,name:(null==f?void 0:null===(t=f.creator)||void 0===t?void 0:t.name)||"",avatarUrl:(null==f?void 0:null===(a=f.creator)||void 0===a?void 0:a.avatar)||"",description:null==g?void 0:null===(v=g.creator)||void 0===v?void 0:v.description,links:null==g?void 0:null===(p=g.creator)||void 0===p?void 0:p.links}),(0,s.jsxs)("span",{className:"text-gray-500 text-xs",children:["opened ",function(e){if(!e)return"";let t="string"==typeof e?new Date(e):e;if(isNaN(t.getTime()))return"Invalid date";let a=new Date,s=a.getTime()-t.getTime();if(s<0)return t.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"});if(s<6e4){let e=Math.floor(s/1e3);return e<=1?"just now":"".concat(e," secs ago")}if(s<36e5){let e=Math.floor(s/6e4);return 1===e?"1 min ago":"".concat(e," mins ago")}if(s<864e5){let e=Math.floor(s/36e5);return 1===e?"1 hr ago":"".concat(e," hrs ago")}if(s<6048e5){let e=Math.floor(s/864e5);return 1===e?"yesterday":"".concat(e," days ago")}if(s<2592e6){let e=Math.floor(s/6048e5);return 1===e?"last week":"".concat(e," weeks ago")}return t.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:a.getFullYear()!==t.getFullYear()?"numeric":void 0})}(null==g?void 0:g.created_at)]})]}),(0,s.jsxs)(i.$,{variant:"ghost",className:"h-7 py-1 px-2 mx-2 text-xs",onClick:()=>S(!0),children:[(0,s.jsx)(u.A,{className:"h-3 w-3 mr-2"}),"Edit"]})]}),(0,s.jsx)("div",{className:"p-2 min-h-[120px]",children:k?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"min-h-[180px]",children:(0,s.jsx)(l.A,{content:N,onChange:w,isEditable:k,users:b||[]})}),(0,s.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-2",children:[(0,s.jsx)(i.$,{className:(0,c.cn)(n.RA,"h-8"),onClick:()=>{w((null==g?void 0:g.description)||""),S(!1)},disabled:_,children:"Cancel"}),(0,s.jsx)(i.$,{className:(0,c.cn)(n.iH,"h-8"),onClick:C,disabled:_,children:_?"Saving...":"Save"})]})]}):(0,s.jsx)(l.A,{content:N||"<p><em><sub>No Description Provided</sub></em></p>",onChange:w,isEditable:!1})})]})};var p=a(79749);let j=(e,t)=>[...e.map(e=>({id:(0,p.A)(),created_at:new Date(e.created_at),type:"activity",value:e})),...t.map(e=>({id:(0,p.A)(),created_at:new Date(e.created_at),type:"comment",value:e}))].sort((e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime());var f=a(54136),g=a(46367),y=a(67396);let b=e=>{let{user:t}=e;return t?(0,s.jsx)(d.q,{id:t.id,name:t.name,avatarUrl:t.avatar,description:t.description,links:t.links,avatarStyles:"w-4 h-4"}):(0,s.jsx)("span",{children:"Unknown User"})},N=e=>{let{users:t}=e;return t&&0!==t.length?(0,s.jsx)("div",{className:"flex items-center flex-wrap gap-2",children:null==t?void 0:t.map(e=>(0,s.jsx)(d.q,{id:e.id,name:e.name,avatarUrl:e.avatar,description:e.description,links:e.links,avatarStyles:"w-4 h-4"},e.id))}):(0,s.jsx)("span",{children:"Unknown Users"})},w=e=>{let{status:t}=e,a=(0,h.useParams)();return t?(0,s.jsx)(y.default,{href:"/projects/".concat(a.projectId,"/settings/statuses?option_id=").concat(t.id),children:(0,s.jsx)(f.n,{label:t.label,color:t.color})}):(0,s.jsx)("span",{children:"Unknown Status"})},k=e=>{let{label:t}=e,a=(0,h.useParams)();return t?(0,s.jsx)(y.default,{href:"/projects/".concat(a.projectId,"/settings/labels?label_id=").concat(t.id),children:(0,s.jsx)(g.c,{labelText:t.label,description:t.description,color:t.color})}):(0,s.jsx)("span",{children:"Unknown Label"})},S=e=>{let{labels:t}=e,a=(0,h.useParams)();return t&&0!==t.length?t.map(e=>(0,s.jsx)(y.default,{href:"/projects/".concat(a.projectId,"/settings/labels?label_id=").concat(e.id),children:(0,s.jsx)(g.c,{labelText:e.label,description:e.description,color:e.color})},e.id)):(0,s.jsx)("span",{children:"Unknown Labels"})},_=e=>{let{value:t}=e,a=new Date(t),l=new Date().getFullYear(),i=a.getFullYear()===l?a.toLocaleDateString("en-US",{month:"short",day:"numeric"}):a.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return(0,s.jsx)("span",{children:i})},D=e=>{let{activity:t,allMembers:a,statuses:l,labels:i}=e;return(0,s.jsx)("div",{className:"flex items-center flex-wrap text-xs gap-1 ml-3 my-3",children:t.content.map((e,t)=>{if("string"==typeof e)return(0,s.jsx)("span",{className:"text-gray-400",children:e},t);switch(e.type){case"user":return(0,s.jsx)(b,{user:null==a?void 0:a.find(t=>t.id===e.id)},t);case"status":return(0,s.jsx)(w,{status:null==l?void 0:l.find(t=>t.id===e.id)},t);case"label":return(0,s.jsx)(k,{label:null==i?void 0:i.find(t=>t.id===e.id)},t);case"labels":var r;return(0,s.jsx)(S,{labels:null===(r=e.ids.map(e=>null==i?void 0:i.find(t=>t.id===e)))||void 0===r?void 0:r.filter(e=>void 0!==e)},t);case"date":return(0,s.jsx)(_,{value:e.value},t);case"users":return(0,s.jsx)(N,{users:e.ids.map(e=>null==a?void 0:a.find(t=>t.id===e)).filter(e=>void 0!==e)},t);default:return null}})})};var C=a(20750),A=a(88587);let I=(0,a(94457).U)(),F={getTaskComments:async e=>{let{data:t,error:a}=await I.from("comments").select("\n        id,\n        content,\n        created_at,\n        updated_at,\n        task_id,\n        user:user_id (\n          id,\n          name,\n          avatar,\n          description,\n          links\n        )\n      ").eq("task_id",e).order("created_at",{ascending:!0});if(a)throw a;return t},create:async e=>{let{data:t,error:a}=await I.from("comments").insert({...e,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select("\n        id,\n        content,\n        created_at,\n        updated_at,\n        task_id,\n        user:user_id (\n          id,\n          name,\n          avatar,\n          description,\n          links\n        )\n      ").single();if(a)throw a;return t},delete:async e=>{let{error:t}=await I.from("comments").delete().eq("id",e);if(t)throw t},update:async(e,t)=>{let{data:a,error:s}=await I.from("comments").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select("\n        id,\n        content,\n        created_at,\n        updated_at,\n        task_id,\n        user:user_id (\n          id,\n          name,\n          avatar,\n          description,\n          links\n        )\n      ").single();if(s)throw s;return a}};var T=a(35906),q=a(547),E=a(25848);let P=e=>{let t=(0,T.jE)(),{data:a,isLoading:s}=(0,q.I)({queryKey:["comments",e],queryFn:()=>F.getTaskComments(e),enabled:!!e,staleTime:3e5,gcTime:18e5}),{mutate:l}=(0,E.n)({mutationFn:e=>F.create(e),onSuccess:a=>{t.setQueryData(["comments",e],e=>e?[...e,a]:[a])}}),{mutate:i}=(0,E.n)({mutationFn:e=>F.delete(e),onSuccess:(a,s)=>{t.setQueryData(["comments",e],e=>e?e.filter(e=>e.id!==s):[])}}),{mutate:r}=(0,E.n)({mutationFn:e=>{let{commentId:t,content:a}=e;return F.update(t,{content:a})},onSuccess:a=>{t.setQueryData(["comments",e],e=>e?e.map(e=>e.id===a.id?a:e):[a])}});return{taskComments:a,isLoading:s,createComment:l,deleteComment:i,updateComment:r}};var U=a(46403),O=a(84858),R=a(19993),L=a(83572);let M=L.bL,z=L.l9,Q=L.ZL,H=r.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(L.hJ,{className:(0,c.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l,ref:t})});H.displayName=L.hJ.displayName;let K=r.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsxs)(Q,{children:[(0,s.jsx)(H,{}),(0,s.jsx)(L.UC,{ref:t,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-slate-200 bg-white p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg dark:border-slate-800 dark:bg-slate-950",a),...l})]})});K.displayName=L.UC.displayName;let J=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};J.displayName="AlertDialogHeader";let $=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,c.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};$.displayName="AlertDialogFooter";let V=r.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(L.hE,{ref:t,className:(0,c.cn)("text-lg font-semibold",a),...l})});V.displayName=L.hE.displayName;let Y=r.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(L.VY,{ref:t,className:(0,c.cn)("text-sm text-slate-500 dark:text-slate-400",a),...l})});Y.displayName=L.VY.displayName;let B=r.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(L.rc,{ref:t,className:(0,c.cn)((0,i.r)(),a),...l})});B.displayName=L.rc.displayName;let W=r.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(L.ZD,{ref:t,className:(0,c.cn)((0,i.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...l})});W.displayName=L.ZD.displayName;var Z=a(89134);let G=e=>{let{comment:t}=e,[a,o]=(0,r.useState)(t.content),[x,h]=(0,r.useState)(!1),{user:v}=(0,U.i)(),{selectedTask:p}=(0,m.H)(),{updateComment:j,deleteComment:f}=P((null==p?void 0:p.id)||""),{createActivity:g}=(0,A.V)((null==p?void 0:p.id)||""),y=(null==v?void 0:v.id)===t.user.id,b=async()=>{if(a.trim())try{await j({commentId:t.id,content:a}),h(!1)}catch(e){(0,Z.oR)({title:"Failed to update comment",variant:"destructive"})}},N=async()=>{try{await f(t.id),await g({task_id:null==p?void 0:p.id,user_id:null==v?void 0:v.id,content:[{type:"user",id:null==v?void 0:v.id},"deleted a comment on",{type:"date",value:new Date().toISOString()}]})}catch(e){(0,Z.oR)({title:"Failed to delete comment",variant:"destructive"})}};return(0,s.jsxs)("div",{className:"border border-sky-200 dark:border-blue-900 rounded",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between bg-sky-100 dark:bg-slate-900 rounded-t border-b border-sky-200 dark:border-blue-900 overflow-x-auto px-4 py-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)("span",{children:(0,s.jsx)(d.q,{id:t.user.id||"",name:t.user.name||"",avatarUrl:t.user.avatar||"",description:t.user.description||"",links:t.user.links||[]})})," ",(0,s.jsx)("span",{className:"text-gray-500",children:new Date(t.created_at).toDateString()})]}),y&&(0,s.jsxs)(C.rI,{children:[(0,s.jsx)(C.ty,{children:(0,s.jsx)(O.A,{className:"w-6 h-6 text-gray-600"})}),(0,s.jsxs)(C.SQ,{className:"mr-4",children:[(0,s.jsxs)(C._2,{onClick:()=>h(!0),children:[(0,s.jsx)(u.A,{className:"w-4 h-4 mr-2"}),"Edit"]}),(0,s.jsxs)(M,{children:[(0,s.jsx)(z,{asChild:!0,children:(0,s.jsxs)(C._2,{className:"text-red-500 bg-transparent hover:bg-red-200 hover:dark:bg-red-950",onSelect:e=>e.preventDefault(),children:[(0,s.jsx)(R.A,{className:"w-3 h-3 mr-2"}),"Delete"]})}),(0,s.jsxs)(K,{children:[(0,s.jsxs)(J,{children:[(0,s.jsx)(V,{children:"Delete Comment"}),(0,s.jsx)(Y,{children:"Are you sure you want to delete this comment? This action cannot be undone."})]}),(0,s.jsxs)($,{children:[(0,s.jsx)(W,{children:"Cancel"}),(0,s.jsx)(B,{onClick:N,className:"bg-red-500 hover:bg-red-600",children:"Delete"})]})]})]})]})]})]}),(0,s.jsx)("div",{className:"p-2 min-h-[120px]",children:x?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"min-h-[180px]",children:(0,s.jsx)(l.A,{content:a,onChange:o,isEditable:x})}),(0,s.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-2",children:[(0,s.jsx)(i.$,{className:(0,c.cn)(n.RA,"h-8"),onClick:()=>{o(t.content),h(!1)},children:"Cancel"}),(0,s.jsx)(i.$,{className:(0,c.cn)(n.iH,"h-8"),onClick:b,disabled:!a.trim()||a===t.content,children:"Update Comment"})]})]}):(0,s.jsx)(l.A,{content:a,onChange:o,isEditable:!1})})]})};var X=a(80937),ee=a(63898),et=a(43670),ea=a(9955),es=a(15785),el=a(51124),ei=a(89282),er=a(68236),en=a(53803);let ed=()=>{let e=(0,h.useParams)(),{selectedTask:t}=(0,m.H)(),{members:a,reloadProjectTasks:l}=(0,x.J)(e.projectId),{task:n,updateAssignees:c}=(0,o.R)((null==t?void 0:t.id)||""),{createActivities:u}=(0,A.V)((null==t?void 0:t.id)||""),{user:v}=(0,U.i)(),{owner:p}=(0,en.E)(e.projectId),[j,f]=(0,r.useState)(""),[g,y]=(0,r.useState)([]),[b,N]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(null==n?void 0:n.assignees)&&y(n.assignees.map(e=>e.id))},[null==n?void 0:n.assignees]);let w=(0,r.useMemo)(()=>a&&p?a.some(e=>e.id===p.id)?a:[{id:p.id,name:p.name,email:p.email,avatar:p.avatar,description:p.description,links:p.links},...a]:null!=a?a:[],[a,p]),k=e=>{y(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},S=async e=>{var a,s;if(!e&&JSON.stringify(g.sort())!==JSON.stringify(null==n?void 0:null===(a=n.assignees)||void 0===a?void 0:a.map(e=>e.id).sort())){let e=(null==n?void 0:null===(s=n.assignees)||void 0===s?void 0:s.map(e=>e.id))||[],a=g.filter(t=>!e.includes(t)),i=e.filter(e=>!g.includes(e));await c(g),await l();let r=[];a.length>0&&(1===a.length&&a[0]===(null==v?void 0:v.id)?r.push({task_id:null==t?void 0:t.id,user_id:null==v?void 0:v.id,content:[{type:"user",id:null==v?void 0:v.id},"self-assigned this on",{type:"date",value:new Date().toISOString()}]}):r.push({task_id:null==t?void 0:t.id,user_id:null==v?void 0:v.id,content:[{type:"user",id:null==v?void 0:v.id},"assigned",{type:"users",ids:a},"to this on",{type:"date",value:new Date().toISOString()}]})),i.length>0&&(1===i.length&&i[0]===(null==v?void 0:v.id)?r.push({task_id:null==t?void 0:t.id,user_id:null==v?void 0:v.id,content:[{type:"user",id:null==v?void 0:v.id},"removed themselves from this task on",{type:"date",value:new Date().toISOString()}]}):r.push({task_id:null==t?void 0:t.id,user_id:null==v?void 0:v.id,content:[{type:"user",id:null==v?void 0:v.id},"unassigned",{type:"users",ids:i},"from this task on",{type:"date",value:new Date().toISOString()}]})),r.length>0&&await u(r)}N(e)},_=async()=>{(null==v?void 0:v.id)&&(await c([v.id]),await l(),await u([{task_id:null==t?void 0:t.id,user_id:v.id,content:[{type:"user",id:v.id},"self-assigned this on",{type:"date",value:new Date().toISOString()}]}]),y([v.id]))},D=null==w?void 0:w.filter(e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(j.toLowerCase())}),C=e=>g.includes(e);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center text-gray-500",children:[(0,s.jsx)("span",{className:"text-xs",children:"Assignees"}),(0,s.jsxs)(el.AM,{open:b,onOpenChange:S,children:[(0,s.jsx)(el.Wv,{children:(0,s.jsx)(er.A,{className:"w-4 h-4"})}),(0,s.jsxs)(el.hl,{className:"mr-4",children:[(0,s.jsx)(es.J,{className:"mb-2 text-xs",children:"Assign people to this task"}),(0,s.jsx)(ea.p,{placeholder:"filter assignees",className:"h-7 my-1 rounded-sm bg-gray-100 dark:bg-black",value:j,onChange:e=>f(e.target.value)}),(0,s.jsx)(ei.Separator,{className:"my-2"}),null==D?void 0:D.map(e=>{var t;return(0,s.jsxs)("div",{className:"flex items-center hover:cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-900 p-1 text-xs",onClick:()=>k(e.id||""),children:[(0,s.jsx)(et.S,{checked:C(e.id||""),className:"w-4 h-4 mr-4 rounded-sm bg-gray-200 dark:bg-black border border-gray-300 dark:border-gray-900"}),(0,s.jsxs)(ee.eu,{className:"w-4 h-4 mr-2",children:[(0,s.jsx)(ee.BK,{src:e.avatar}),(0,s.jsx)(ee.q5,{children:(null===(t=e.name)||void 0===t?void 0:t.charAt(0))||""})]}),(0,s.jsx)("span",{children:e.name})]},e.id)})]})]})]}),(0,s.jsx)("div",{className:"text-xs pt-2 pb-4",children:(null==n?void 0:n.assignees)&&n.assignees.length>0?(0,s.jsx)("div",{className:"flex flex-col gap-2",children:n.assignees.map(e=>(0,s.jsx)(d.q,{id:e.id,name:e.name,avatarUrl:e.avatar,description:e.description,links:e.links},e.id))}):(0,s.jsxs)(s.Fragment,{children:["No one -",(0,s.jsx)(i.$,{onClick:_,className:"px-1 text-blue-500 bg-transparent text-xs h-4 font-normal hover:bg-transparent",children:"Assign yourself"})]})})]})},eo=()=>{let{projectId:e}=(0,h.useParams)(),{selectedTask:t,closeDrawer:a}=(0,m.H)(),{deleteTask:l}=(0,o.R)((null==t?void 0:t.id)||""),[n,d]=(0,r.useState)(!1),{reloadProjectTasks:c}=(0,x.J)(e),u=async()=>{d(!0),await l(),await c(),a(),(0,Z.oR)({title:"Task deleted",description:"The task has been deleted successfully"}),d(!1)};return(0,s.jsx)("div",{className:"py-4",children:(0,s.jsxs)(i.$,{onClick:u,className:"flex h-6 justify-start w-full text-red-500 bg-transparent hover:bg-red-200 hover:dark:bg-red-950",disabled:n,children:[(0,s.jsx)(R.A,{className:"w-3 h-3 mr-2"}),n?"Deleting...":"Delete"]})})},ec=()=>{let{projectId:e}=(0,h.useParams)(),{members:t}=(0,x.J)(e),{owner:a}=(0,en.E)(e);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex justify-between items-center text-gray-500 pt-4",children:(0,s.jsx)("span",{className:"text-xs",children:"Participants"})}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 text-xs py-2",children:[(0,s.jsx)(d.q,{id:(null==a?void 0:a.id)||"",name:(null==a?void 0:a.name)||"",avatarUrl:(null==a?void 0:a.avatar)||"",description:null==a?void 0:a.description,links:null==a?void 0:a.links,showPreviewName:!1}),null==t?void 0:t.map(e=>(0,s.jsx)(d.q,{id:e.id,name:e.name||"",avatarUrl:e.avatar||"",description:e.description,links:e.links,showPreviewName:!1},e.id))]})]})};var eu=a(39286),em=a(93518),ex=a(46967),eh=a(62222);function ev(e){let{className:t,classNames:a,showOutsideDays:l=!0,...r}=e;return(0,s.jsx)(eh.hv,{showOutsideDays:l,className:(0,c.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,c.cn)((0,i.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-slate-500 rounded-md w-9 font-normal text-[0.8rem] dark:text-slate-400",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-slate-100/50 [&:has([aria-selected])]:bg-slate-100 first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20 dark:[&:has([aria-selected].day-outside)]:bg-slate-800/50 dark:[&:has([aria-selected])]:bg-slate-800",day:(0,c.cn)((0,i.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-slate-900 text-slate-50 hover:bg-slate-900 hover:text-slate-50 focus:bg-slate-900 focus:text-slate-50 dark:bg-slate-50 dark:text-slate-900 dark:hover:bg-slate-50 dark:hover:text-slate-900 dark:focus:bg-slate-50 dark:focus:text-slate-900",day_today:"bg-slate-100 text-slate-900 dark:bg-slate-800 dark:text-slate-50",day_outside:"day-outside text-slate-500 opacity-50 aria-selected:bg-slate-100/50 aria-selected:text-slate-500 aria-selected:opacity-30 dark:text-slate-400 dark:aria-selected:bg-slate-800/50 dark:aria-selected:text-slate-400",day_disabled:"text-slate-500 opacity-50 dark:text-slate-400",day_range_middle:"aria-selected:bg-slate-100 aria-selected:text-slate-900 dark:aria-selected:bg-slate-800 dark:aria-selected:text-slate-50",day_hidden:"invisible",...a},components:{IconLeft:e=>{let{...t}=e;return(0,s.jsx)(em.A,{className:"h-4 w-4"})},IconRight:e=>{let{...t}=e;return(0,s.jsx)(ex.A,{className:"h-4 w-4"})}},...r})}ev.displayName="Calendar";var ep=a(32);let ej=e=>{let{date:t,onSelect:a}=e;return(0,s.jsxs)(el.AM,{children:[(0,s.jsx)(el.Wv,{children:t?(0,s.jsx)("span",{className:"text-xs text-gray-700 dark:text-gray-300",children:(0,ep.GP)(t,"PPP")}):(0,s.jsx)("span",{className:"text-xs text-gray-700 dark:text-gray-300",children:"No Date"})}),(0,s.jsx)(el.hl,{className:"w-auto p-0 mr-4",children:(0,s.jsx)(ev,{mode:"single",selected:t,onSelect:a,initialFocus:!0})})]})};var ef=a(95475);let eg=()=>{let e=(0,h.useParams)(),{selectedTask:t,projectName:a,updateTaskSize:l,updateTaskPriority:i}=(0,m.H)(),{projectTasks:r,statuses:n,priorities:d,sizes:c}=(0,x.J)(e.projectId),{task:u,updatePriority:v,updateSize:p,updateDates:j}=(0,o.R)((null==t?void 0:t.id)||""),g=(e,t,a)=>{var s,l,i,r,n,d;let o=e.filter(e=>e.status_id===a);if(!t){let e=o.filter(e=>!e.priority);return 0===e.length?(null!==(l=null===(s=o[o.length-1])||void 0===s?void 0:s.statusPosition)&&void 0!==l?l:0)-10:Math.min(...e.map(e=>{var t;return null!==(t=e.statusPosition)&&void 0!==t?t:0}))-10}let c=o.filter(e=>{var a,s;return(null!==(s=null===(a=e.priority)||void 0===a?void 0:a.order)&&void 0!==s?s:0)>=t}),u=o.filter(e=>{var a;return(null===(a=e.priority)||void 0===a?void 0:a.order)===t}),m=o.filter(e=>{var a;return(null===(a=e.priority)||void 0===a?void 0:a.order)===t-1});return 0===c.length?(null!==(i=Math.max(...o.map(e=>{var t;return null!==(t=e.statusPosition)&&void 0!==t?t:0})))&&void 0!==i?i:0)+100:u.length>0?(null!==(r=u[u.length-1].statusPosition)&&void 0!==r?r:0)-100:m.length>0?(null!==(n=m[0].statusPosition)&&void 0!==n?n:0)+100:(null!==(d=Math.max(...o.map(e=>{var t;return null!==(t=e.statusPosition)&&void 0!==t?t:0})))&&void 0!==d?d:0)+100},y=async e=>{var a;if(!(null==t?void 0:t.id))return;let s=e&&(null==d?void 0:d.find(t=>t.id===e))||null,l=g(r||[],null!==(a=null==s?void 0:s.order)&&void 0!==a?a:null,t.status_id||"");try{await ef.v.board.updatePosition(t.id,l),await v(e||null),null==i||i(t.id,s)}catch(e){(0,Z.oR)({title:"Failed to update priority",variant:"destructive"})}},b=e=>{if(!(null==t?void 0:t.id))return;p(e||null);let a=e&&(null==c?void 0:c.find(t=>t.id===e))||null;null==l||l(t.id,a)},N=(e,a)=>{(null==t?void 0:t.id)&&j({startDate:"startDate"===e?(null==a?void 0:a.toISOString())||null:(null==u?void 0:u.startDate)||null,endDate:"endDate"===e?(null==a?void 0:a.toISOString())||null:(null==u?void 0:u.endDate)||null})},w=null==n?void 0:n.find(e=>e.id===(null==u?void 0:u.status_id)),k=(null==u?void 0:u.startDate)?new Date(u.startDate):void 0,S=(null==u?void 0:u.endDate)?new Date(u.endDate):void 0,_=null==d?void 0:d.sort((e,t)=>e.order-t.order),D=null==c?void 0:c.sort((e,t)=>e.order-t.order);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"py-4",children:[(0,s.jsx)("span",{className:"text-gray-500 text-xs",children:"Project"}),(0,s.jsx)("p",{className:"text-xs py-1",children:a})]}),(0,s.jsxs)("div",{className:"flex gap-8 items-center text-gray-500",children:[(0,s.jsx)("span",{className:"text-xs",children:"Status"}),(0,s.jsx)(eu.E,{variant:"secondary",className:"text-[11px] bg-blue-100 text-blue-700 border-blue-300 dark:text-blue-300 dark:bg-blue-950 border dark:border-blue-800",children:(null==w?void 0:w.label)||"None"})]}),(0,s.jsxs)("div",{className:"flex justify-between text-gray-500 py-2",children:[(0,s.jsx)("span",{className:"text-xs",children:"Priority"}),(0,s.jsxs)(C.rI,{children:[(0,s.jsx)(C.ty,{className:"text-xs",children:(null==u?void 0:u.priority)?(0,s.jsx)(f.n,{color:u.priority.color,label:u.priority.label}):"None"}),(0,s.jsxs)(C.SQ,{className:"mr-4",children:[(0,s.jsx)(C.lp,{className:"text-xs",children:"Set Priority"}),(0,s.jsx)(C.mB,{}),(0,s.jsxs)(C._2,{onClick:()=>y(null),children:[(0,s.jsx)("span",{className:"w-3 h-3 mr-2"}),(0,s.jsx)("div",{className:"flex-grow",children:"None"})]}),null==_?void 0:_.map(e=>(0,s.jsxs)(C._2,{onClick:()=>y(e.id),children:[(0,s.jsx)("span",{className:"w-3 h-3 mr-2 border rounded-full",style:{borderColor:e.color}}),(0,s.jsx)("div",{className:"flex-grow",children:e.label})]},e.id))]})]})]}),(0,s.jsxs)("div",{className:"flex justify-between text-gray-500 py-2",children:[(0,s.jsx)("span",{className:"text-xs",children:"Size"}),(0,s.jsxs)(C.rI,{children:[(0,s.jsx)(C.ty,{className:"text-xs",children:(null==u?void 0:u.size)?(0,s.jsx)(f.n,{color:u.size.color,label:u.size.label}):"None"}),(0,s.jsxs)(C.SQ,{className:"mr-4",children:[(0,s.jsx)(C.lp,{className:"text-xs",children:"Set Size"}),(0,s.jsx)(C.mB,{}),(0,s.jsxs)(C._2,{onClick:()=>b(null),children:[(0,s.jsx)("span",{className:"w-3 h-3 mr-2"}),(0,s.jsx)("div",{className:"flex-grow",children:"None"})]}),null==D?void 0:D.map(e=>(0,s.jsxs)(C._2,{onClick:()=>b(e.id),children:[(0,s.jsx)("span",{className:"w-3 h-3 mr-2 border rounded-full",style:{borderColor:e.color}}),(0,s.jsx)("div",{className:"flex-grow",children:e.label})]},e.id))]})]})]}),(0,s.jsxs)("div",{className:"flex justify-between text-gray-500 py-2",children:[(0,s.jsx)("span",{className:"text-xs",children:"Start date"}),(0,s.jsx)(ej,{date:k,onSelect:e=>N("startDate",e)})]}),(0,s.jsxs)("div",{className:"flex justify-between text-gray-500 pt-2 pb-4",children:[(0,s.jsx)("span",{className:"text-xs",children:"End date"}),(0,s.jsx)(ej,{date:S,onSelect:e=>N("endDate",e)})]})]})};var ey=a(21868);let eb=r.forwardRef((e,t)=>{let{className:a,children:l,...i}=e;return(0,s.jsxs)(ey.bL,{ref:t,className:(0,c.cn)("relative overflow-hidden",a),...i,children:[(0,s.jsx)(ey.LM,{className:"h-full w-full rounded-[inherit]",children:l}),(0,s.jsx)(eN,{}),(0,s.jsx)(ey.OK,{})]})});eb.displayName=ey.bL.displayName;let eN=r.forwardRef((e,t)=>{let{className:a,orientation:l="vertical",...i}=e;return(0,s.jsx)(ey.VM,{ref:t,orientation:l,className:(0,c.cn)("flex touch-none select-none transition-colors","vertical"===l&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===l&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...i,children:(0,s.jsx)(ey.lr,{className:"relative flex-1 rounded-full bg-slate-200 dark:bg-slate-800"})})});eN.displayName=ey.VM.displayName;let ew=()=>{let e=(0,h.useParams)(),{selectedTask:t,updateTaskLabels:a}=(0,m.H)(),{labels:l}=(0,x.J)(e.projectId),{task:n,updateLabels:d}=(0,o.R)((null==t?void 0:t.id)||""),{createActivities:c}=(0,A.V)((null==t?void 0:t.id)||""),{user:u}=(0,U.i)(),[v,p]=(0,r.useState)(""),[j,f]=(0,r.useState)([]),[b,N]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(null==n?void 0:n.labels)&&(f(n.labels.map(e=>e.id)),null==a||a((null==t?void 0:t.id)||"",null==n?void 0:n.labels))},[null==n?void 0:n.labels]);let w=e=>{f(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},k=async e=>{var a,s;if(!e&&JSON.stringify(j.sort())!==JSON.stringify(null==n?void 0:null===(a=n.labels)||void 0===a?void 0:a.map(e=>e.id).sort())){let e=(null==n?void 0:null===(s=n.labels)||void 0===s?void 0:s.map(e=>e.id))||[],a=j.filter(t=>!e.includes(t)),l=e.filter(e=>!j.includes(e));await d(j);let i=[];a.length>0&&i.push({task_id:null==t?void 0:t.id,user_id:null==u?void 0:u.id,content:[{type:"user",id:null==u?void 0:u.id},"added",{type:"labels",ids:a},"on",{type:"date",value:new Date().toISOString()}]}),l.length>0&&i.push({task_id:null==t?void 0:t.id,user_id:null==u?void 0:u.id,content:[{type:"user",id:null==u?void 0:u.id},"removed",{type:"labels",ids:l},"on",{type:"date",value:new Date().toISOString()}]}),i.length>0&&await c(i)}N(e)},S=null==l?void 0:l.filter(e=>e.label.toLowerCase().includes(v.toLowerCase())),_=e=>j.includes(e);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center text-gray-500 pt-4",children:[(0,s.jsx)("span",{className:"text-xs",children:"Labels"}),(0,s.jsxs)(el.AM,{open:b,onOpenChange:k,children:[(0,s.jsx)(el.Wv,{children:(0,s.jsx)(er.A,{className:"w-4 h-4"})}),(0,s.jsxs)(el.hl,{className:"mr-4",children:[(0,s.jsx)(es.J,{className:"mb-2 text-xs",children:"Apply labels to this task"}),(0,s.jsx)(ea.p,{placeholder:"filter labels",className:"h-7 my-1 rounded-sm bg-gray-100 dark:bg-black",value:v,onChange:e=>p(e.target.value)}),(0,s.jsx)(ei.Separator,{className:"my-2"}),(0,s.jsx)(eb,{className:"h-[200px]",children:null==S?void 0:S.map(e=>(0,s.jsxs)("div",{className:"flex items-start hover:cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-900 p-1 text-xs",onClick:()=>w(e.id),children:[(0,s.jsx)(et.S,{checked:_(e.id),className:"w-4 h-4 mr-4 rounded-sm bg-gray-200 dark:bg-black border border-gray-300 dark:border-gray-900"}),(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"w-3 h-3 mr-2 rounded-full",style:{backgroundColor:e.color}}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{children:e.label}),(0,s.jsx)("div",{className:"text-[10px] text-gray-400 dark:text-gray-500",children:e.description})]})]})]},e.id))}),(0,s.jsx)(ei.Separator,{className:"my-1"}),(0,s.jsx)(y.default,{href:"/projects/".concat(e.projectId,"/settings/labels"),children:(0,s.jsx)(i.$,{variant:"ghost",className:"w-full h-7 text-xs",children:"Edit labels"})})]})]})]}),(0,s.jsx)("div",{className:"text-xs pt-2 pb-4 space-x-1",children:(null==n?void 0:n.labels)&&n.labels.length>0?n.labels.map(e=>(0,s.jsx)(g.c,{color:e.color,labelText:e.label},e.id)):(0,s.jsx)("span",{className:"text-gray-500",children:"None yet"})})]})},ek=()=>{let[e,t]=r.useState(""),[a,o]=r.useState(0),{selectedTask:u}=(0,m.H)(),{createComment:x}=P((null==u?void 0:u.id)||""),{user:h}=(0,U.i)(),v=async()=>{if(e.trim()&&(null==u?void 0:u.id)&&(null==h?void 0:h.id))try{await x({task_id:u.id,user_id:h.id,content:e}),t(""),o(e=>e+1)}catch(e){(0,Z.oR)({title:"Failed to add comment",variant:"destructive"})}};return(0,s.jsxs)("div",{className:"my-6",children:[(0,s.jsxs)("div",{className:" pb-4 flex items-center space-x-2",children:[(0,s.jsx)(d.q,{id:(null==h?void 0:h.id)||"",name:(null==h?void 0:h.name)||"",avatarUrl:(null==h?void 0:h.avatar)||"",description:(null==h?void 0:h.description)||"",links:(null==h?void 0:h.links)||[],avatarStyles:"w-7 h-7",showPreviewName:!1}),(0,s.jsx)("span",{className:"font-bold",children:"Add a comment"})]}),(0,s.jsx)(l.A,{content:e,onChange:t,isEditable:!0,resetKey:a}),(0,s.jsx)("div",{className:"flex justify-end py-2",children:(0,s.jsx)(i.$,{className:(0,c.cn)(n.iH),onClick:v,disabled:!e.trim(),children:"Add Comment"})})]})},eS=r.memo(e=>{let{item:t,allMembers:a,statuses:l,labels:i}=e;return"activity"===t.type?(0,s.jsx)(D,{activity:t.value,allMembers:a,statuses:l,labels:i}):(0,s.jsx)("div",{className:"bg-white dark:bg-gray-950 my-6 ml-[-2rem]",children:(0,s.jsx)(G,{comment:t.value})})});eS.displayName="MemoizedTimelineItem";let e_=()=>{let{selectedTask:e}=(0,m.H)(),{taskActivities:t}=(0,A.V)(null==e?void 0:e.id),a=(0,h.useParams)().projectId,{statuses:l,members:i,labels:n}=(0,x.J)(a),{user:d}=(0,U.i)(),{taskComments:o}=P(null==e?void 0:e.id),c=(0,r.useMemo)(()=>i&&d?i.some(e=>e.id===d.id)?i:[...i,d]:i,[i,d]),u=(0,r.useMemo)(()=>j(t||[],o||[]),[t,o]);return(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row py-6 gap-6",children:[(0,s.jsxs)("div",{className:"flex-grow",children:[(0,s.jsx)("p",{className:"font-bold pb-2",children:"Description"}),(0,s.jsx)(v,{}),(0,s.jsx)("div",{className:"border-l pt-4 ml-8",children:u.map(e=>(0,s.jsx)(eS,{item:e,allMembers:c||[],statuses:l||[],labels:n||[]},e.id))}),(0,s.jsx)(ek,{})]}),(0,s.jsxs)("div",{className:"w-full lg:w-[255px]",children:[(0,s.jsx)(ed,{}),(0,s.jsx)(X.wv,{}),(0,s.jsx)(ew,{}),(0,s.jsx)(X.wv,{}),(0,s.jsx)(eg,{}),(0,s.jsx)(X.wv,{}),(0,s.jsx)(ec,{}),(0,s.jsx)(X.wv,{}),(0,s.jsx)(eo,{})]})]})}},54136:(e,t,a)=>{a.d(t,{n:()=>d});var s=a(95155),l=a(92686),i=a(12115),r=a(39286),n=a(67113);let d=e=>{let{color:t,label:a}=e,{theme:d}=(0,n.D)(),[o,c]=(0,i.useState)(void 0);return(0,i.useEffect)(()=>{c((0,l.um)(t,d))},[d,t]),o&&(0,s.jsx)(r.E,{style:o,children:a})}},46367:(e,t,a)=>{a.d(t,{c:()=>l});var s=a(95155);a(12115);let l=e=>{let{labelText:t,description:a,color:l}=e;return(0,s.jsx)("span",{title:a||t,className:"mx-1 px-2 inline-flex text-xs leading-5 font-semibold rounded-full text-white",style:{backgroundColor:l},children:t})}},33375:(e,t,a)=>{a.d(t,{q:()=>p});var s=a(95155),l=a(12115),i=a(92098),r=a(29602);let n=i.bL,d=i.l9,o=l.forwardRef((e,t)=>{let{className:a,align:l="center",sideOffset:n=4,...d}=e;return(0,s.jsx)(i.UC,{ref:t,align:l,sideOffset:n,className:(0,r.cn)("z-50 w-64 rounded-md border border-slate-200 bg-white p-4 text-slate-950 shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-slate-800 dark:bg-slate-950 dark:text-slate-50",a),...d})});o.displayName=i.UC.displayName;var c=a(61231),u=a(67396),m=a(89282),x=a(54113);let h=(0,l.memo)(e=>{let{link:t}=e;return(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(x.A,{className:"w-3 h-3 mr-1"}),(0,s.jsx)(u.default,{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-muted-foreground hover:text-sky-500",children:t.label}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground px-3",children:"|"})]})});h.displayName="UserLink";let v=(0,l.memo)(e=>{let{name:t,avatarUrl:a,description:l,links:i,id:r}=e;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(u.default,{href:"/profile/".concat(r),children:(0,s.jsx)(c.H,{src:a,fallback:t.charAt(0)})}),(0,s.jsx)("p",{className:"text-bold py-2 text-lg",children:t})]}),l&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground py-3",children:l}),i&&i.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.Separator,{className:"my-2"}),(0,s.jsx)("div",{className:"flex items-center",children:null==i?void 0:i.map(e=>(0,s.jsx)(h,{link:e},e.id))})]})]})});v.displayName="UserCardContent";let p=(0,l.memo)(e=>{let{id:t,name:a,avatarUrl:l,description:i,links:m,showPreviewName:x=!0,avatarStyles:h}=e;return(0,s.jsxs)(n,{children:[(0,s.jsx)(u.default,{href:"/profile/".concat(t),children:(0,s.jsx)(d,{asChild:!0,children:(0,s.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer",children:[(0,s.jsx)(c.H,{src:l,fallback:a.charAt(0),className:(0,r.cn)("w-6 h-6",h)}),x&&(0,s.jsx)("span",{className:"text-bold",children:a})]})})}),(0,s.jsx)(o,{side:"top",className:"w-80",children:(0,s.jsx)(v,{id:t,name:a,avatarUrl:l,description:i,links:m})})]})});p.displayName="UserCard"},43670:(e,t,a)=>{a.d(t,{S:()=>d});var s=a(95155),l=a(12115),i=a(86352),r=a(98867),n=a(29602);let d=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(i.bL,{ref:t,className:(0,n.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-slate-200 border-slate-900 ring-offset-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-950 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-slate-900 data-[state=checked]:text-slate-50 dark:border-slate-800 dark:border-slate-50 dark:ring-offset-slate-950 dark:focus-visible:ring-slate-300 dark:data-[state=checked]:bg-slate-50 dark:data-[state=checked]:text-slate-900",a),...l,children:(0,s.jsx)(i.C1,{className:(0,n.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(r.A,{className:"h-4 w-4"})})})});d.displayName=i.bL.displayName},51124:(e,t,a)=>{a.d(t,{AM:()=>n,Wv:()=>d,hl:()=>o});var s=a(95155),l=a(12115),i=a(80532),r=a(29602);let n=i.bL,d=i.l9,o=l.forwardRef((e,t)=>{let{className:a,align:l="center",sideOffset:n=4,...d}=e;return(0,s.jsx)(i.ZL,{children:(0,s.jsx)(i.UC,{ref:t,align:l,sideOffset:n,className:(0,r.cn)("z-50 w-72 rounded-md border border-slate-200 bg-white p-4 text-slate-950 shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-slate-800 dark:bg-slate-950 dark:text-slate-50",a),...d})})});o.displayName=i.UC.displayName},88587:(e,t,a)=>{a.d(t,{V:()=>d});let s=(0,a(94457).U)(),l={getTaskActivities:async e=>{let{data:t,error:a}=await s.from("activities").select("\n        id,\n        content,\n        created_at,\n        updated_at,\n        task_id,\n        user:user_id (\n          id,\n          name,\n          avatar\n        )\n      ").eq("task_id",e).order("created_at",{ascending:!1});if(a)throw a;return t},create:async e=>{let{data:t,error:a}=await s.from("activities").insert({...e,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select("\n        id,\n        content,\n        created_at,\n        updated_at,\n        task_id,\n        user_id,\n        user:user_id (\n          id,\n          name,\n          avatar\n        )\n      ").single();if(a)throw a;return t},createMany:async e=>{let{data:t,error:a}=await s.from("activities").insert(e.map(e=>({...e,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}))).select("\n        id,\n        content,\n        created_at,\n        updated_at,\n        task_id,\n        user_id,\n        user:user_id (\n          id,\n          name,\n          avatar\n        )\n      ");if(a)throw a;return t},delete:async e=>{let{error:t}=await s.from("activities").delete().eq("id",e);if(t)throw t},update:async(e,t)=>{let{data:a,error:l}=await s.from("activities").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select("\n        id,\n        content,\n        created_at,\n        updated_at,\n        task_id,\n        user_id,\n        user:user_id (\n          id,\n          name,\n          avatar\n        )\n      ").single();if(l)throw l;return a}};var i=a(35906),r=a(547),n=a(25848);let d=e=>{let t=(0,i.jE)(),{data:a,isLoading:s}=(0,r.I)({queryKey:["activities",e],queryFn:()=>l.getTaskActivities(e),enabled:!!e,staleTime:3e5,gcTime:18e5}),{mutate:d}=(0,n.n)({mutationFn:e=>l.create(e),onSuccess:a=>{t.setQueryData(["activities",e],e=>e?[a,...e]:[a])}}),{mutate:o}=(0,n.n)({mutationFn:e=>l.createMany(e),onSuccess:a=>{t.setQueryData(["activities",e],e=>e?[...a,...e]:a)}}),{mutate:c}=(0,n.n)({mutationFn:e=>l.delete(e),onSuccess:(a,s)=>{t.setQueryData(["activities",e],e=>e?e.filter(e=>e.id!==s):[])}}),{mutate:u}=(0,n.n)({mutationFn:e=>{let{activityId:t,updates:a}=e;return l.update(t,a)},onSuccess:a=>{t.setQueryData(["activities",e],e=>e?e.map(e=>e.id===a.id?a:e):[a])}});return{taskActivities:a,isLoading:s,createActivity:d,createActivities:o,deleteActivity:c,updateActivity:u}}},46403:(e,t,a)=>{a.d(t,{i:()=>d});var s=a(94457),l=a(547),i=a(12115);let r=(0,s.U)(),n=async e=>{if(!e)return null;let{data:t,error:a}=await r.from("users").select("id, name, avatar, description, links").eq("id",e).single();return a?(console.error("Error fetching user details:",a),null):{id:t.id,name:t.name,avatar:t.avatar,description:t.description,links:t.links}},d=()=>{let[e,t]=(0,i.useState)(""),[a,s]=(0,i.useState)(!0);(0,i.useEffect)(()=>{r.auth.getSession().then(e=>{var a;let{data:{session:l}}=e;t((null==l?void 0:null===(a=l.user)||void 0===a?void 0:a.id)||""),s(!1)})},[]);let{data:d,isLoading:o}=(0,l.I)({queryKey:["user",e],queryFn:()=>n(e),enabled:!!e,staleTime:3e5,gcTime:18e5});return{user:d,isLoading:a||o}}},53803:(e,t,a)=>{a.d(t,{E:()=>i,o:()=>r});var s=a(49297),l=a(547);let i=e=>{let{data:t,isLoading:a,error:i}=(0,l.I)({queryKey:["project",e,"owner"],queryFn:()=>s.d.members.getProjectOwner(e),enabled:!!e,staleTime:3e5,gcTime:18e5});return{owner:t,isLoading:a,error:i}},r=async(e,t)=>{await e.prefetchQuery({queryKey:["project",t,"owner"],queryFn:()=>s.d.members.getProjectOwner(t),staleTime:3e5,gcTime:18e5})}},84954:(e,t,a)=>{a.d(t,{R:()=>n,v:()=>d});var s=a(95475),l=a(35906),i=a(547),r=a(25848);let n=e=>{let t=(0,l.jE)(),{data:a}=(0,i.I)({queryKey:["task",e],queryFn:()=>s.v.details.get(e),enabled:!!e,staleTime:1/0,gcTime:18e5}),{mutate:n}=(0,r.n)({mutationFn:t=>s.v.details.update(e,{description:t}),onSuccess:()=>{t.invalidateQueries({queryKey:["task",e]})}}),{mutate:d}=(0,r.n)({mutationFn:t=>s.v.details.update(e,{assignees:t}),onSuccess:()=>{t.invalidateQueries({queryKey:["task",e]})}}),{mutate:o}=(0,r.n)({mutationFn:t=>s.v.details.update(e,{labels:t}),onSuccess:()=>{t.invalidateQueries({queryKey:["task",e]})}}),{mutate:c}=(0,r.n)({mutationFn:t=>s.v.details.update(e,{status_id:t}),onSuccess:()=>{t.invalidateQueries({queryKey:["task",e]})}}),{mutate:u}=(0,r.n)({mutationFn:t=>s.v.details.update(e,{priority:t}),onSuccess:()=>{t.invalidateQueries({queryKey:["task",e]})}}),{mutate:m}=(0,r.n)({mutationFn:t=>s.v.details.update(e,{size:t}),onSuccess:()=>{t.invalidateQueries({queryKey:["task",e]})}}),{mutate:x}=(0,r.n)({mutationFn:t=>s.v.details.updateDates(e,t),onSuccess:()=>{t.invalidateQueries({queryKey:["task",e]})}}),{mutate:h}=(0,r.n)({mutationFn:()=>s.v.details.delete(e),onSuccess:()=>{t.invalidateQueries({queryKey:["tasks"]})}});return{task:a,updateDescription:n,updateAssignees:d,updateLabels:o,updateStatus:c,updatePriority:u,updateSize:m,updateDates:x,deleteTask:h}},d=async(e,t)=>{await e.prefetchQuery({queryKey:["task",t],queryFn:()=>s.v.details.get(t),staleTime:1/0,gcTime:18e5})}},92686:(e,t,a)=>{function s(e,t){if(t<0||t>100)throw Error("Lightness should be a percentage between 0 and 100");let a=e.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);if(!a)throw Error("Invalid HSL color string");let s=a[1],l=a[2];return"hsl(".concat(s,", ").concat(l,"%, ").concat(t,"%)")}a.d(t,{s_:()=>i,um:()=>l,zl:()=>s});let l=(e,t)=>({backgroundColor:s(e,"light"===t?90:15),color:s(e,"light"===t?40:70),border:"1px solid ".concat(s(e,"light"===t?60:45))});function i(e,t){let a=new Set;return e.forEach(e=>{Object.keys(e).forEach(e=>{e!==t&&a.add(e)})}),Array.from(a)}}}]);