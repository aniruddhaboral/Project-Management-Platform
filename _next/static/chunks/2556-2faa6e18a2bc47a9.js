"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2556],{22730:(e,t,r)=>{r.d(t,{Hn:()=>i,RA:()=>a,_Q:()=>o,iH:()=>s});let a="\n  h-8\n  rounded-sm\n  border\n  bg-gray-100\n  border-gray-200\n  text-gray-500\n  hover:bg-gray-200\n  hover:border-gray-300\n  dark:text-gray-300\n  dark:bg-gray-800\n  dark:border-gray-700\n  dark:hover:bg-gray-900\n  dark:hover:border-gray-800\n  ",s="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-sm h-8",i="bg-blue-500 text-white hover:bg-blue-600",o="text-red-400 hover:bg-red-100 hover:text-red-700 hover:border hover:border-red-200 dark:text-red-600 dark:hover:bg-red-950 dark:hover:text-red-300 dark:hover:border-red-900"},14085:(e,t,r)=>{r.d(t,{$:()=>l,r:()=>d});var a=r(95155),s=r(12115),i=r(12317),o=r(31027),n=r(29602);let d=(0,o.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=s.forwardRef((e,t)=>{let{className:r,variant:s,size:o,asChild:l=!1,...c}=e,u=l?i.DX:"button";return(0,a.jsx)(u,{className:(0,n.cn)(d({variant:s,size:o,className:r})),ref:t,...c})});l.displayName="Button"},9955:(e,t,r)=>{r.d(t,{p:()=>o});var a=r(95155),s=r(12115),i=r(29602);let o=s.forwardRef((e,t)=>{let{className:r,type:s,...o}=e;return(0,a.jsx)("input",{type:s,className:(0,i.cn)("flex h-10 w-full rounded-md border border-slate-200 bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-slate-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-950 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-slate-800 dark:bg-slate-950 dark:ring-offset-slate-950 dark:placeholder:text-slate-400 dark:focus-visible:ring-slate-300",r),ref:t,...o})});o.displayName="Input"},89134:(e,t,r)=>{r.d(t,{dj:()=>p,oR:()=>u});var a=r(12115);let s=0,i=new Map,o=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,t)},n=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?o(r):e.toasts.forEach(e=>{o(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],l={toasts:[]};function c(e){l=n(l,e),d.forEach(e=>{e(l)})}function u(e){let{...t}=e,r=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||a()}}}),{id:r,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function p(){let[e,t]=a.useState(l);return a.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},62138:(e,t,r)=>{r.d(t,{d4:()=>a,kJ:()=>s});var a=function(e){return e.TasksByStatus="status,none",e.TasksByLabel="label,none",e.TasksBySize="size,none",e.TasksByPriority="priority,none",e.TasksByStatusGroupedByLabel="status,label",e.TasksByStatusGroupedBySize="status,size",e.TasksByStatusGroupedByPriority="status,priority",e.TasksByLabelGroupedByStatus="label,status",e.TasksByLabelGroupedBySize="label,size",e.TasksByLabelGroupedByPriority="label,priority",e.TasksBySizeGroupedByStatus="size,status",e.TasksBySizeGroupedByLabel="size,label",e.TasksBySizeGroupedByPriority="size,priority",e.TasksByPriorityGroupedByStatus="priority,status",e.TasksByPriorityGroupedByLabel="priority,label",e.TasksByPriorityGroupedBySize="priority,size",e}({}),s=function(e){return e.UPDATE_PROJECT="update_project",e.DELETE_PROJECT="delete_project",e.CLOSE_PROJECT="close_project",e.VIEW_SETTINGS="view_settings",e.VIEW_OPTIONS="view_options",e.CREATE_OPTIONS="create_options",e.UPDATE_OPTIONS="update_options",e.DELETE_OPTIONS="delete_options",e.VIEW_MEMBERS="view_members",e.INVITE_MEMBERS="invite_members",e.UPDATE_MEMBER_ROLE="update_member_role",e.REMOVE_MEMBERS="remove_members",e.VIEW_TASKS="view_tasks",e.MOVE_TASKS="move_tasks",e.CREATE_TASKS="create_tasks",e.UPDATE_TASKS="update_tasks",e.DELETE_TASKS="delete_tasks",e}({})},45334:(e,t,r)=>{r.d(t,{D:()=>i});var a=r(12115),s=r(92914);let i=e=>{let{projectId:t}=e,{permissions:r,roles:i,isCreator:o,fetchProjectAccess:n,requiresMinRole:d}=(0,s.z)();return(0,a.useEffect)(()=>{r[t]||n(t)},[t,r,n]),{can:e=>{var a,s;return null!==(s=null===(a=r[t])||void 0===a?void 0:a[e])&&void 0!==s&&s},hasMinRole:e=>d(t,e),role:i[t],isCreator:o[t],isLoading:!r[t]}}},29602:(e,t,r)=>{r.d(t,{cn:()=>i});var a=r(43463),s=r(69795);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}},92914:(e,t,r)=>{r.d(t,{z:()=>n});var a=r(99827),s=r(94457),i=r(62138);let o=(0,s.U)(),n=(0,a.v)((e,t)=>({permissions:{},roles:{},isCreator:{},setProjectAccess:(t,r)=>{let{permissions:a,role:s,isCreator:i}=r;return e(e=>({permissions:{...e.permissions,[t]:a},roles:{...e.roles,[t]:s},isCreator:{...e.isCreator,[t]:i}}))},fetchProjectAccess:async e=>{if(!e)return;let{data:{session:r}}=await o.auth.getSession();if(!r)return;let{data:a}=await o.from("projects").select("created_by").eq("id",e).maybeSingle(),{data:s,error:n}=await o.from("project_members").select("role").eq("project_id",e).eq("user_id",r.user.id).maybeSingle();n&&console.error("Error fetching member role:",n);let d=(null==a?void 0:a.created_by)===r.user.id,l=d?"owner":(null==s?void 0:s.role)||"read",c=function(e){let t=[i.kJ.UPDATE_PROJECT,i.kJ.DELETE_PROJECT,i.kJ.CLOSE_PROJECT],r=[i.kJ.VIEW_SETTINGS,i.kJ.VIEW_OPTIONS,i.kJ.CREATE_OPTIONS,i.kJ.UPDATE_OPTIONS,i.kJ.DELETE_OPTIONS],a=[i.kJ.VIEW_MEMBERS,i.kJ.INVITE_MEMBERS,i.kJ.UPDATE_MEMBER_ROLE,i.kJ.REMOVE_MEMBERS],s=[i.kJ.VIEW_TASKS,i.kJ.MOVE_TASKS,i.kJ.CREATE_TASKS,i.kJ.UPDATE_TASKS,i.kJ.DELETE_TASKS],o={owner:[...t,...r,...a,...s],admin:[i.kJ.CLOSE_PROJECT,i.kJ.UPDATE_PROJECT,...r,...a,...s],write:[i.kJ.VIEW_SETTINGS,i.kJ.VIEW_OPTIONS,i.kJ.CREATE_OPTIONS,i.kJ.UPDATE_OPTIONS,i.kJ.VIEW_MEMBERS,...s],read:[i.kJ.VIEW_OPTIONS,i.kJ.VIEW_MEMBERS,i.kJ.VIEW_TASKS,i.kJ.MOVE_TASKS]}[e];return Object.values(i.kJ).reduce((e,t)=>({...e,[t]:o.includes(t)}),{})}(l);t().setProjectAccess(e,{permissions:c,role:l,isCreator:d})},reset:()=>e({permissions:{},roles:{},isCreator:{}}),requiresMinRole:(e,r)=>{let a={owner:3,admin:2,write:1,read:0},s=t().roles[e];return!!s&&a[s]>=a[r]}}))},49297:(e,t,r)=>{r.d(t,{d:()=>s});let a=(0,r(94457).U)(),s={management:{create:async(e,t)=>{try{let{data:r,error:s}=await a.from("projects").insert({name:e.name,description:e.description,readme:e.readme,created_by:t,updated_at:new Date,closed:!1}).select().single();if(s)throw s;if(e.statuses){let{error:t}=await a.from("statuses").insert(e.statuses.map((e,t)=>({...e,project_id:r.id,order:t,limit:5,updated_at:new Date})));if(t)throw t}if(e.labels){let{error:t}=await a.from("labels").insert(e.labels.map(e=>({...e,project_id:r.id,updated_at:new Date})));if(t)throw t}if(e.priorities){let{error:t}=await a.from("priorities").insert(e.priorities.map(e=>({...e,project_id:r.id,updated_at:new Date})));if(t)throw t}if(e.sizes){let{error:t}=await a.from("sizes").insert(e.sizes.map(e=>({...e,project_id:r.id,updated_at:new Date})));if(t)throw t}return r}catch(e){throw e}},update:async(e,t)=>{let{error:r}=await a.from("projects").update({...t,updated_at:new Date}).eq("id",e);if(r)throw r},delete:async e=>{let{error:t}=await a.from("projects").delete().eq("id",e);if(t)throw t},close:async e=>{let{error:t}=await a.from("projects").update({closed:!0,updated_at:new Date}).eq("id",e);if(t)throw t},reopen:async e=>{let{error:t}=await a.from("projects").update({closed:!1,updated_at:new Date}).eq("id",e);if(t)throw t}},fields:{getStatuses:async e=>{let{data:t,error:r}=await a.from("statuses").select("*").eq("project_id",e).order("order");if(r)throw r;return t},getLabels:async e=>{let{data:t,error:r}=await a.from("labels").select("*").eq("project_id",e);if(r)throw r;return t},getPriorities:async e=>{let{data:t,error:r}=await a.from("priorities").select("*").eq("project_id",e).order("order");if(r)throw r;return t},getSizes:async e=>{let{data:t,error:r}=await a.from("sizes").select("*").eq("project_id",e).order("order");if(r)throw r;return t}},members:{getAll:async e=>{let{data:t,error:r}=await a.from("project_members").select("\n          user:users (\n            id,\n            name,\n            avatar,\n            description,\n            links\n          )\n        ").eq("project_id",e);if(r)throw r;return t.map(e=>e.user)},getProjectOwner:async e=>{let{data:t,error:r}=await a.from("projects").select("\n          creator:created_by (\n            id,\n            name,\n            email,\n            avatar,\n            description,\n            links,\n            created_at,\n            updated_at\n          )\n        ").eq("id",e).single();if(r)throw r;if(!(null==t?void 0:t.creator))return null;let s=t.creator;return{id:s.id,name:s.name,email:s.email,avatar:s.avatar,description:s.description,links:s.links,created_at:s.created_at,updated_at:s.updated_at}}},getUserProjects:async e=>{let[t,r]=await Promise.all([a.from("projects").select("*").eq("created_by",e).order("created_at",{ascending:!1}),a.from("project_members").select("\n          project:projects (*) \n        ").eq("user_id",e).eq("invitationStatus","accepted").order("created_at",{ascending:!1}).not("project.created_by","eq",e)]);if(t.error)throw t.error;if(r.error)throw r.error;return[...t.data,...r.data.map(e=>e.project)]}}},94457:(e,t,r)=>{r.d(t,{U:()=>s});var a=r(95382);let s=()=>(0,a.createBrowserClient)("https://odwydhaqevttdqexyfdw.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9kd3lkaGFxZXZ0dGRxZXh5ZmR3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYyNTQwMDcsImV4cCI6MjA3MTgzMDAwN30.iTpgn3KmQbthonggnzc1Qur9jLQ-LNl30G3oLvAs10w")}}]);